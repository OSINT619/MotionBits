<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MotionBits Particle Library</title>
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body, html {
    margin: 0; padding: 0; height: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f0f3;
    color: #333;
    display: flex;
    flex-direction: column;
    user-select: none;
  }

  header {
    padding: 1.5rem 2rem;
    font-weight: 900;
    font-size: 2.5rem;
    color: #222;
    text-align: center;
    user-select: text;
    /* Deep embossed */
    text-shadow:
      2px 2px 0 #a8a8a8,
      4px 4px 6px #d6d6d6,
      -1px -1px 1px #fff,
      -4px -4px 8px #f8f8f8;
    background: #f0f0f3;
    box-shadow:
      inset 5px 5px 10px #bebebe,
      inset -5px -5px 10px #ffffff;
  }

  main {
    flex: 1;
    display: flex;
    padding: 2rem;
    gap: 2rem;
  }

  /* Sidebar nav */
  nav {
    flex: 0 0 280px;
    background: #f0f0f3;
    border-radius: 24px;
    box-shadow:
      8px 8px 16px #bebebe,
      -8px -8px 16px #ffffff;
    display: flex;
    flex-direction: column;
    padding: 1.5rem;
    user-select: none;
  }
  nav label {
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: #555;
    user-select: text;
  }
  nav select {
    border-radius: 12px;
    border: none;
    padding: 0.8rem 1rem;
    font-size: 1.1rem;
    font-weight: 600;
    box-shadow:
      5px 5px 10px #bebebe,
      -5px -5px 10px #ffffff;
    background: #f0f0f3;
    cursor: pointer;
    transition: box-shadow 0.3s ease;
    user-select: none;
  }
  nav select:focus {
    outline: none;
    box-shadow:
      inset 3px 3px 6px #bebebe,
      inset -3px -3px 6px #ffffff;
  }

  /* Instructions */
  .instructions {
    margin-top: 2rem;
    flex-grow: 1;
    font-size: 1rem;
    line-height: 1.4;
    color: #444;
    /* Beveled text */
    text-shadow:
      1px 1px 0 #fff,
      2px 2px 4px #bbb;
    user-select: text;
    overflow-y: auto;
  }
  .instructions strong {
    color: #222;
    font-weight: 700;
    text-shadow:
      1px 1px 0 #fff,
      2px 2px 3px #aaa;
  }
  .instructions pre {
    background: #e0e0e3;
    padding: 1rem;
    border-radius: 16px;
    box-shadow:
      inset 3px 3px 6px #bebebe,
      inset -3px -3px 6px #ffffff;
    overflow-x: auto;
    font-family: 'Source Code Pro', monospace, monospace;
    font-size: 0.85rem;
    margin-top: 0.5rem;
    white-space: pre-wrap;
  }

  /* Animation display */
  .animation-area {
    flex: 1;
    background: #f0f0f3;
    border-radius: 32px;
    box-shadow:
      12px 12px 24px #bebebe,
      -12px -12px 24px #ffffff;
    position: relative;
    overflow: hidden;
  }
  canvas#c {
    width: 100%;
    height: 100%;
    display: block;
    border-radius: 32px;
    box-shadow:
      inset 4px 4px 10px #c1c1c1,
      inset -4px -4px 10px #ffffff;
    background-color: black;
  }

  /* Responsive */
  @media (max-width: 900px) {
    main {
      flex-direction: column;
      padding: 1rem;
    }
    nav {
      flex: none;
      width: 100%;
      margin-bottom: 1rem;
      border-radius: 20px;
      padding: 1rem;
    }
    .animation-area {
      height: 350px;
      border-radius: 20px;
      margin-bottom: 1rem;
    }
    header {
      font-size: 2rem;
      padding: 1rem 1rem;
    }
  }
</style>
</head>
<body>

<header>MotionBits Particle Library</header>

<main>
  <nav>
    <label for="animationSelect">Choose an animation</label>
    <select id="animationSelect" aria-label="Select particle animation"></select>
    <div class="instructions" aria-live="polite" aria-atomic="true"></div>
  </nav>

  <section class="animation-area" aria-label="Particle animation preview">
    <canvas id="c"></canvas>
  </section>
</main>

<script>
(() => {
  const canvas = document.getElementById('c');
  const gl = canvas.getContext('webgl2');
  const select = document.getElementById('animationSelect');
  const instructions = document.querySelector('.instructions');

  if (!gl) {
    alert('WebGL 2 not supported in your browser.');
    return;
  }

  // Particle animations data
  const animations = {
    "particle-1": {
      name: "Shape Morpher",
      vertexShader: `#version 300 es
        in vec4 a_position;
        void main() {
          gl_Position = a_position;
        }`,
      fragmentShader: `#version 300 es
        precision highp float;
        out vec4 o;
        uniform vec2 r;
        uniform float t;
        void main() {
          vec2 uv = (gl_FragCoord.xy / r) * 2.0 - 1.0;
          float morph = 0.5 + 0.5 * sin(t + uv.x * 10.0);
          o = vec4(vec3(morph), 1.0);
        }`,
      usage: `
Copy the entire block below into an HTML file and open it in a WebGL2-compatible browser:

\`\`\`html
<canvas id="c"></canvas>
<style>
  body, html, canvas {
    margin: 0; padding: 0; overflow: hidden; background-color: black;
  }
  canvas { display: block; }
</style>
<script>
  const c = document.getElementById("c");
  const gl = c.getContext("webgl2");
  // vertex & fragment shaders omitted for brevity, see main code above
  // Setup and render shader...
</script>
\`\`\`
      `
    },
    "particle-2": {
      name: "Color Swapper",
      vertexShader: `#version 300 es
        in vec4 a_position;
        void main() {
          gl_Position = a_position;
        }`,
      fragmentShader: `#version 300 es
        precision highp float;
        out vec4 o;
        uniform vec2 r;
        uniform float t;
        void main() {
          vec2 uv = (gl_FragCoord.xy / r) * 2.0 - 1.0;
          vec3 col = mix(vec3(1,0,0), vec3(0,0,1), abs(sin(t)));
          o = vec4(col,1);
        }`,
      usage: `
Copy this snippet for a basic color swapping animation:

\`\`\`html
<canvas id="c"></canvas>
<style>
  body, html, canvas {
    margin: 0; padding: 0; overflow: hidden; background-color: black;
  }
  canvas { display: block; }
</style>
<script>
  const c = document.getElementById("c");
  const gl = c.getContext("webgl2");
  // Setup & render code here...
</script>
\`\`\`
      `
    },
    // Add all your animations here...
    "particle-3": {
      name: "Size Changer",
      vertexShader: `#version 300 es
        in vec4 a_position;
        void main() {
          gl_Position = a_position;
        }`,
      fragmentShader: `#version 300 es
        precision highp float;
        out vec4 o;
        uniform vec2 r;
        uniform float t;
        void main() {
          float size = 0.5 + 0.5 * sin(t);
          vec2 uv = (gl_FragCoord.xy / r) * 2.0 - 1.0;
          float d = length(uv);
          float circle = smoothstep(size, size - 0.01, d);
          o = vec4(vec3(1.0 - circle), 1.0);
        }`,
      usage: `Copy & paste this for a dynamic size-changing circle animation.`
    }
    // You can expand this object with full shader codes from your collection.
  };

  // Populate dropdown
  Object.entries(animations).forEach(([key, anim]) => {
    const option = document.createElement('option');
    option.value = key;
    option.textContent = anim.name;
    select.appendChild(option);
  });

  let currentProgram = null;
  let positionBuffer = null;
  let positionAttributeLocation = null;
  let resolutionUniformLocation = null;
  let timeUniformLocation = null;

  function createShader(type, source) {
    const shader = gl.createShader(type);
    gl.shaderSource(shader, source);
    gl.compileShader(shader);
    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
      console.error('Shader compile error:', gl.getShaderInfoLog(shader), source);
      gl.deleteShader(shader);
      return null;
    }
    return shader;
  }

  function createProgram(vertexShader, fragmentShader) {
    const program = gl.createProgram();
    gl.attachShader(program, vertexShader);
    gl.attachShader(program, fragmentShader);
    gl.linkProgram(program);
    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
      console.error('Program link error:', gl.getProgramInfoLog(program));
      gl.deleteProgram(program);
      return null;
    }
    return program;
  }

  function setupProgram(anim) {
    if (currentProgram) {
      gl.deleteProgram(currentProgram);
      currentProgram = null;
    }
    const vertexShader = createShader(gl.VERTEX_SHADER, anim.vertexShader);
    const fragmentShader = createShader(gl.FRAGMENT_SHADER, anim.fragmentShader);
    if (!vertexShader || !fragmentShader) {
      alert('Failed to compile shaders for ' + anim.name);
      return false;
    }
    currentProgram = createProgram(vertexShader, fragmentShader);
    if (!currentProgram) {
      alert('Failed to link program for ' + anim.name);
      return false;
    }

    positionAttributeLocation = gl.getAttribLocation(currentProgram, "a_position");
    resolutionUniformLocation = gl.getUniformLocation(currentProgram, "r");
    timeUniformLocation = gl.getUniformLocation(currentProgram, "t");

    positionBuffer = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
    const positions = [-1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1];
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);

    gl.useProgram(currentProgram);
    gl.enableVertexAttribArray(positionAttributeLocation);
    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
    gl.vertexAttribPointer(positionAttributeLocation, 2, gl.FLOAT, false, 0, 0);

    return true;
  }

  function resizeCanvas() {
    const dpr = window.devicePixelRatio || 1;
    const width = canvas.clientWidth * dpr | 0;
    const height = canvas.clientHeight * dpr | 0;
    if (canvas.width !== width || canvas.height !== height) {
      canvas.width = width;
      canvas.height = height;
    }
    gl.viewport(0, 0, canvas.width, canvas.height);
  }

  let startTime = performance.now();

  function render() {
    resizeCanvas();

    const time = (performance.now() - startTime) * 0.001;
    gl.clearColor(0, 0, 0, 1);
    gl.clear(gl.COLOR_BUFFER_BIT);

    gl.uniform2f(resolutionUniformLocation, canvas.width, canvas.height);
    gl.uniform1f(timeUniformLocation, time);

    gl.drawArrays(gl.TRIANGLES, 0, 6);

    requestAnimationFrame(render);
  }

  function loadAnimation(key) {
    const anim = animations[key];
    if (!anim) return;
    if (!setupProgram(anim)) return;

    instructions.innerHTML = `<strong>${anim.name}</strong><br>${anim.usage.trim()}`;
    startTime = performance.now();
  }

  // Init
  select.addEventListener('change', e => loadAnimation(e.target.value));
  // Set default animation
  loadAnimation(select.value || Object.keys(animations)[0]);
  render();

})();
</script>

</body>
</html>
